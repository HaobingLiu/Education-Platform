<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <title>Dashio - Bootstrap Admin Template</title>

    <!-- Favicons -->
    <link href="/templates/servermaterial/img/favicon.png" rel="icon">
    <link href="/templates/servermaterial/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Bootstrap core CSS -->
    <link href="/templates/servermaterial/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!--external css-->
    <link href="/templates/servermaterial/lib/font-awesome/css/font-awesome.css" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css" href="/templates/servermaterial/css/zabuto_calendar.css">
    <link rel="stylesheet" type="text/css" href="/templates/servermaterial/lib/gritter/css/jquery.gritter.css"/>
    <!-- Custom styles for this template -->
    <link href="/templates/servermaterial/css/style.css" rel="stylesheet">
    <link href="/templates/servermaterial/css/style-responsive.css" rel="stylesheet">
    <script src="/templates/servermaterial/lib/chart-master/Chart.js"></script>
    <style>
        .ttttt {
            position: relative;
        }

        #login-page {
            position: absolute;
            width: 100%;
            z-index: 100;
            height: 100%;
            background: rgba(0, 0, 0, 0.52) none repeat scroll 0% 0%;
            opacity: 1;
        }

        #register-page {
            position: absolute;
            width: 100%;
            z-index: 100;
            height: 100%;
            background: rgba(0, 0, 0, 0.52) none repeat scroll 0% 0%;
            opacity: 1;
        }

        #main-content {
            z-index: 80;
        }


    </style>
    <!-- =======================================================
      Template Name: Dashio
      Template URL: https://templatemag.com/dashio-bootstrap-admin-template/
      Author: TemplateMag.com
      License: https://templatemag.com/license/
    ======================================================= -->
</head>

<body>

<section id="container" class="ttttt">
    <!--header start-->
    {% include 'servermaterial/header.html' %}
    <!--header end-->
    <!--main content start-->
    <div id="login-page" style="display: none;">
        <div class="container">

            <form class="form-login" action="#" method="post">
                <h2 class="form-login-heading">登录</h2>
                <div class="login-wrap">
                    <label class="checkbox">
		                <span class="pull-right">
		                    <a data-toggle="modal" href="login.html#myModal">忘记密码</a>
		                </span>
                    </label>
                    <label for="id_username">用户名：</label>
                    <input type="text" name="id_username" class="form-control" placeholder="用户名" id="id_username"
                           autofocus>
                    <br>
                    <label for="id_password">密码：</label>
                    <input type="password" name="id_password" class="form-control" placeholder="密码" id="id_password">

                    <h5 id="loginInfo" style="visibility: hidden; color: red">成都机场能见度</h5>
                    <button class="btn btn-theme btn-block" type="button" id="login"><i class="fa fa-lock"></i> 登录
                    </button>
                    <br>
                    <button class="btn btn-theme btn-block" id="register" type="button" name="turn2register"><i
                            class="fa fa-users"></i> 注册
                    </button>
                    </a>
                </div>

                <!-- Modal -->
                <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal"
                     class="modal fade">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;
                                </button>
                                <h4 class="modal-title">忘记密码</h4>
                            </div>
                            <div class="modal-body">
                                <p>请输入用户名：</p>
                                <input id="username" type="text" name="username" placeholder="用户名" autocomplete="off"
                                       class="form-control placeholder-no-fix">

                                <p>请输入邮箱：</p>
                                <input id="email" type="text" name="email" placeholder="邮箱" autocomplete="off"
                                       class="form-control placeholder-no-fix">

                                <p>请输入新密码：</p>
                                <input id="rst_passwd" type="password" placeholder="新密码" name="passwd"
                                       autocomplete="off"
                                       class="form-control placeholder-no-fix">

                                <p>请再次输入新密码：</p>
                                <input id="rst_repasswd" type="password" placeholder="确认新密码" name="repasswd"
                                       autocomplete="off" class="form-control placeholder-no-fix">
                                <br>
                                <div class="alert alert-warning"><p id="message"></p></div>
                            </div>
                            <div class="modal-footer">
                                <button data-dismiss="modal" class="btn btn-default" type="button">取消</button>
                                <button class="btn btn-theme" type="button" onclick="upload()">确认</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- modal -->

            </form>


        </div>
    </div>

    <div id="register-page" style="display: none">
        <div class="container">
            <form class="form-login" action="#" method="post" style="max-width: 450px">
                <h2 class="form-login-heading">注册</h2>
                <div class="login-wrap" style="width: 450px">
                    <div class="col-lg-6">
                        <label for="username">用户名：</label>
                        <input type="text" name="username" class="form-control" placeholder="用户名" id="rusername">
                    </div>
                    <div class="col-lg-6">
                        <label for="name">姓名：</label>
                        <input type="text" name="name" class="form-control" placeholder="姓名" id="rname">
                    </div>

                    <div class="col-lg-6" style="margin-top: 15px">
                        <label for="school">管理范围：</label>
                        <div class="form-group" style="margin-bottom: 0px">
                            <select class="form-control" id="rschool" name="school">
                                <option value="all">全校</option>
                                <option value="机械与动力工程学院">机械与动力工程学院</option>
                                <option value="电子信息与电器工程学院">电子信息与电器工程学院</option>
                                <option value="数学科学学院">数学科学学院</option>
                                <option value="人文学院">人文学院</option>
                                <option value="媒体与设计学院">媒体与设计学院</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-6" style="margin-top: 15px">
                        <label for="job">职务：</label>
                        <input type="text" name="job" class="form-control" placeholder="职务" id="rjob">
                    </div>
                    <div class="col-lg-12" style="margin-top: 15px">
                        <label for="email">邮箱：</label>
                        <input type="text" name="email" class="form-control" placeholder="邮箱" id="remail">
                    </div>
                    <div class="col-lg-6" style="margin-top: 15px">
                        <label for="password">请输入密码：</label>
                        <input type="password" class="form-control" placeholder="密码" id="rpassword" name="password">
                    </div>
                    <div class="col-lg-6" style="margin-top: 15px">
                        <label for="repassword">请确认密码：</label>
                        <input type="password" class="form-control" placeholder="确认密码" id="rrepassword"
                               name="repassword">
                    </div>
                    <div class="col-lg-12">
                        <h5 id="registerInfo" style="visibility: hidden; color: red"></h5>
                    </div>
                    <button class="btn btn-theme btn-block" type="button" id="registerSubmit"><i class="fa fa-lock"></i>提交注册信息
                    </button>
                </div>
            </form>

        </div>
    </div>
    <div id="main-content">
        <div class="wrapper">
            <div class="row">
                <div class="col-lg-9 main-chart">
                    <!--CUSTOM CHART START -->
                    <div class="border-head">
                    </div>
                    <!--custom chart end-->
                    <div class="row mt">
                        <!-- SERVER STATUS PANELS -->
                        <div class="col-md-4 col-sm-4 mb" onclick="window.location.href='/web/supervision'">
                            <!-- REVENUE PANEL -->
                            <div class="green-panel pn">
                                <div class="green-header">
                                    <h3>数据可视化</h3>
                                </div>
                                <div class="chart mt">
                                    <div class="sparkline" data-type="line" data-resize="true" data-height="75"
                                         data-width="90%" data-line-width="1" data-line-color="#fff"
                                         data-spot-color="#fff" data-fill-color="" data-highlight-line-color="#fff"
                                         data-spot-radius="4"
                                         data-data="[200,135,667,333,526,996,564,123,890,464,655]"></div>
                                </div>
                            </div>
                        </div>
                        <!-- /col-md-4-->
                        <div class="col-md-4 col-sm-4 mb" onclick="window.location.href='/web/monitor'">
                            <div class="darkblue-panel pn">
                                <div class="darkblue-header">
                                    <h3><font color="white">监测预警</font></h3>
                                </div>
                                <p>
                                </p>
                                <canvas id="serverstatus02" height="120" width="120"></canvas>
                                <script>
                                    var doughnutData = [{
                                        value: 60,
                                        color: "#1c9ca7"
                                    },
                                        {
                                            value: 40,
                                            color: "#f68275"
                                        }
                                    ];
                                    var myDoughnut = new Chart(document.getElementById("serverstatus02").getContext("2d")).Doughnut(doughnutData);
                                </script>
                            </div>
                            <!--  /darkblue panel -->
                        </div>
                        <!-- /col-md-4 -->
                        <div class="col-md-4 mb" onclick="window.location.href='/web/result'">
                            <!-- WHITE PANEL - TOP USER -->
                            <div class="white-panel pn">
                                <div class="white-header">
                                    <h3><font color="black">学生画像</font></h3>
                                </div>
                                <br/>
                                <p><img src="/templates/servermaterial/img/profile.png" class="img-circle" height="120"
                                        width="120"></p>
                            </div>
                        </div>
                        <!-- /col-md-4 -->
                    </div>

                    <div class="row">
                        <!-- TWITTER PANEL -->
                        <!-- /col-md-4 -->
                        <div class="col-md-2 mb">
                        </div>
                        <div class="col-md-4 col-sm-4 mb" onclick="window.location.href='/web/recommend'">
                            <div class="grey-panel pn donut-chart">
                                <div class="grey-header">
                                    <h3>图书推荐</h3>
                                </div>
                                <p><img src="/templates/servermaterial/img/book.png" class="img-circle" height="120"
                                        width="120"></p>
                                {#                                <canvas id="serverstatus01" height="120" width="120"></canvas>#}
                                {#                                <script>#}
                                {#                                    var doughnutData = [{#}
                                {#                                        value: 70,#}
                                {#                                        color: "#FF6B6B"#}
                                {#                                    },#}
                                {#                                        {#}
                                {#                                            value: 30,#}
                                {#                                            color: "#fdfdfd"#}
                                {#                                        }#}
                                {#                                    ];#}
                                {#                                    var myDoughnut = new Chart(document.getElementById("serverstatus01").getContext("2d")).Doughnut(doughnutData);#}
                                {#                                </script>#}
                            </div>
                            <!-- /grey-panel -->
                        </div>
                        <!-- /col-md-4 -->
                        <div class="col-md-4 col-sm-4 mb" onclick="window.location.href='/web/data_import_export'">
                            <div class="darkblue-panel pn">
                                <div class="darkblue-header">
                                    <h3><font color='white'>数据处理</font></h3>
                                </div>
                                <br/>
                                <p><img src="/templates/servermaterial/img/apple-touch-icon.png" class="img"
                                        height="100px"></p>
                                <!--  /darkblue panel -->
                            </div>
                        </div>


                        <div class="col-md-2 mb">
                        </div>
                        <!-- /col-md-4 -->
                    </div>
                </div>
                <!-- /col-lg-9 END SECTION MIDDLE -->
                <!-- **********************************************************************************************************************************************************
                    RIGHT SIDEBAR CONTENT
                    *********************************************************************************************************************************************************** -->
                <!-- /col-lg-3 -->
            </div>
            <!-- /row -->
        </div>
    </div>
    <!--main content end-->
    <!--footer start-->
    {% include 'servermaterial/footer.html' %}
    <!--footer end-->
</section>
<!-- js placed at the end of the document so the pages load faster -->
<script src="/templates/servermaterial/lib/jquery/jquery.min.js"></script>

<script src="/templates/servermaterial/lib/bootstrap/js/bootstrap.min.js"></script>
<script class="include" type="text/javascript" src="/templates/servermaterial/lib/jquery.dcjqaccordion.2.7.js"></script>
<script src="/templates/servermaterial/lib/jquery.scrollTo.min.js"></script>
<script src="/templates/servermaterial/lib/jquery.nicescroll.js" type="text/javascript"></script>
<script src="/templates/servermaterial/lib/jquery.sparkline.js"></script>
<!--common script for all pages-->
<script src="/templates/servermaterial/lib/common-scripts.js"></script>
<script type="text/javascript" src="/templates/servermaterial/lib/gritter/js/jquery.gritter.js"></script>
<script type="text/javascript" src="/templates/servermaterial/lib/gritter-conf.js"></script>
<!--script for this page-->
<script src="/templates/servermaterial/lib/sparkline-chart.js"></script>
<script src="/templates/servermaterial/lib/zabuto_calendar.js"></script>
<script src="/templates/servermaterial/js/jquery.easydrag.handler.beta2.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        return false;
    });
</script>
<script>
    $(document).ready(function () {
        $("#logout").click(function () {
            if (document.getElementById("logout").innerText == "Logout") {
                $.ajax({
                    url: "/web/login/",
                    type: "GET",
                    dataType: "json",
                    success: function (result) {
                    }
                });
                alert("退出登陆成功！");
                document.getElementById("logout").innerText = "点击登陆";
            } else {
                $("#login-page").show();
            }
        })

        $("#register").click(function () {
            {#alert(1000);#}
            $("#login-page").hide();
            $("#register-page").show();
        });

        $("#registerSubmit").click(function () {

            var data = {
                "username": $("#rusername").val(),
                "name": $("#rname").val(),
                "email": $("#remail").val(),
                "job": $("#rjob").val(),
                "school": $("#rschool").find("option:selected").val(),
                "repassword": $("#rrepassword").val(),
                "rpassword": $("#rpassword").val()
            };

            $.ajax({
                url: "/web/register/",
                type: "POST",
                dataType: "json",
                data: data,
                success: function (result) {
                    if (result['message'] != "success") {
                        document.getElementById("registerInfo").innerText = result['message'];
                        $("#registerInfo").css("visibility", "visible");
                    } else {
                        document.getElementById("registerInfo").innerText = "创建成功，3秒后自动返回登陆页面.....";
                        $("#registerInfo").css("visibility", "visible");
                        setTimeout(go, 3000);

                        function go() {
                            $("#login-page").show();
                            $("#register-page").hide();
                        }
                    }
                }

            });

        });


        // 登陆事件
        $("#login").click(function () {
            var data = {"id_username": $("#id_username").val(), "id_password": $("#id_password").val()};
            $.ajax({
                url: "/web/login/",
                type: "POST",
                dataType: "json",
                data: data,
                success: function (result) {
                    if (result['info'] != "success") {
                        document.getElementById("loginInfo").innerText = result['info'];
                        $("#loginInfo").css("visibility", "visible");
                    } else {
                        var userName = result["userName"];
                        var unique_id = $.gritter.add({
                            // (string | mandatory) the heading of the notification
                            title: 'Welcome to 学生成长分析平台!',
                            // (string | mandatory) the text inside the notification
                            text: '你好鸭，' + userName + "老师！",
                            // (string | optional) the image to display on the left
                            image: '/templates/servermaterial/img/peppy.png',
                            // (bool | optional) if you want it to fade out on its own or just sit there
                            sticky: false,
                            // (int | optional) the time you want it to be alive for before fading out
                            time: 100000,
                            // (string | optional) the class name you want to apply to that specific message
                            class_name: 'my-sticky-class'
                        });
                        document.getElementById("logout").innerText = "Logout"
                        $('#login-page').hide();
                    }
                }
            })
        });
    });
</script>
<script type="application/javascript">
    $(document).ready(function () {
        $("#date-popover").popover({
            html: true,
            trigger: "manual"
        });
        $("#date-popover").hide();
        $("#date-popover").click(function (e) {
            $(this).hide();
        });

        $("#my-calendar").zabuto_calendar({
            action: function () {
                return myDateFunction(this.id, false);
            },
            action_nav: function () {
                return myNavFunction(this.id);
            },
            ajax: {
                url: "show_data.php?action=1",
                modal: true
            },
            legend: [{
                type: "text",
                label: "Special event",
                badge: "00"
            },
                {
                    type: "block",
                    label: "Regular event",
                }
            ]
        });
    });

    function myNavFunction(id) {
        $("#date-popover").hide();
        var nav = $("#" + id).data("navigation");
        var to = $("#" + id).data("to");
        console.log('nav ' + nav + ' to: ' + to.month + '/' + to.year);
    }
</script>
</body>

</html>
